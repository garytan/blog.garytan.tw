<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>企業該如何評估 SOC 需要收容哪種資料 | Gary Blog</title>
<meta name=keywords content="security"><meta name=description content="eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料
我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：

VPC flow log
RDS audit log/Aurora audit log
AWS WAF log
AWS Cloudtrail log
AWS GuardDuty log
Amazon CloudFront log
Elastic load balancing (ALB) log

那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。
在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。

Windows eventlog


開啟命令列程序稽核（Command line auditing）
可於群組原則中開啟此功能（電腦設定 > Windows 設定 > 安全性設定 > 進階稽核設定 > 詳細追蹤 > 稽核程序建立），並且開啟新的原則設定（系統管理範本 > 系統 > 稽核程序建立 > 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog  中記錄一筆 4688 的紀錄。


"><meta name=author content><link rel=canonical href=https://blog.garytan.tw/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://blog.garytan.tw/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.garytan.tw/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.garytan.tw/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.garytan.tw/apple-touch-icon.png><link rel=mask-icon href=https://blog.garytan.tw/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.garytan.tw/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.garytan.tw/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/"><meta property="og:site_name" content="Gary Blog"><meta property="og:title" content="企業該如何評估 SOC 需要收容哪種資料"><meta property="og:description" content="eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料
我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：
VPC flow log RDS audit log/Aurora audit log AWS WAF log AWS Cloudtrail log AWS GuardDuty log Amazon CloudFront log Elastic load balancing (ALB) log 那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。
在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。
Windows eventlog 開啟命令列程序稽核（Command line auditing） 可於群組原則中開啟此功能（電腦設定 > Windows 設定 > 安全性設定 > 進階稽核設定 > 詳細追蹤 > 稽核程序建立），並且開啟新的原則設定（系統管理範本 > 系統 > 稽核程序建立 > 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog 中記錄一筆 4688 的紀錄。 "><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-23T11:12:09+08:00"><meta property="article:modified_time" content="2024-05-23T11:12:09+08:00"><meta property="article:tag" content="Security"><meta name=twitter:card content="summary"><meta name=twitter:title content="企業該如何評估 SOC 需要收容哪種資料"><meta name=twitter:description content="eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料
我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：

VPC flow log
RDS audit log/Aurora audit log
AWS WAF log
AWS Cloudtrail log
AWS GuardDuty log
Amazon CloudFront log
Elastic load balancing (ALB) log

那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。
在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。

Windows eventlog


開啟命令列程序稽核（Command line auditing）
可於群組原則中開啟此功能（電腦設定 > Windows 設定 > 安全性設定 > 進階稽核設定 > 詳細追蹤 > 稽核程序建立），並且開啟新的原則設定（系統管理範本 > 系統 > 稽核程序建立 > 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog  中記錄一筆 4688 的紀錄。


"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.garytan.tw/posts/"},{"@type":"ListItem","position":2,"name":"企業該如何評估 SOC 需要收容哪種資料","item":"https://blog.garytan.tw/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"企業該如何評估 SOC 需要收容哪種資料","name":"企業該如何評估 SOC 需要收容哪種資料","description":"eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料\n我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：\nVPC flow log RDS audit log/Aurora audit log AWS WAF log AWS Cloudtrail log AWS GuardDuty log Amazon CloudFront log Elastic load balancing (ALB) log 那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。\n在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。\nWindows eventlog 開啟命令列程序稽核（Command line auditing） 可於群組原則中開啟此功能（電腦設定 \u0026gt; Windows 設定 \u0026gt; 安全性設定 \u0026gt; 進階稽核設定 \u0026gt; 詳細追蹤 \u0026gt; 稽核程序建立），並且開啟新的原則設定（系統管理範本 \u0026gt; 系統 \u0026gt; 稽核程序建立 \u0026gt; 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog 中記錄一筆 4688 的紀錄。 ","keywords":["security"],"articleBody":"eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料\n我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：\nVPC flow log RDS audit log/Aurora audit log AWS WAF log AWS Cloudtrail log AWS GuardDuty log Amazon CloudFront log Elastic load balancing (ALB) log 那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。\n在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。\nWindows eventlog 開啟命令列程序稽核（Command line auditing） 可於群組原則中開啟此功能（電腦設定 \u003e Windows 設定 \u003e 安全性設定 \u003e 進階稽核設定 \u003e 詳細追蹤 \u003e 稽核程序建立），並且開啟新的原則設定（系統管理範本 \u003e 系統 \u003e 稽核程序建立 \u003e 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog 中記錄一筆 4688 的紀錄。 開啟稽核原則 可將稽核原則（電腦設定 \u003e Windows 設定 \u003e 安全性設定 \u003e 本機原則 \u003e 稽核原則 ）中，「物件存取」與「程序追蹤」以外的項目均同步開啟稽核成功及失敗紀錄。 端點 EDR/MDR Log\n端點防毒 Log\n地端基礎設施 Log（VPN/防火牆等主機）\n遠端管理工具\n如：AnyDesk/TeamViewer 我們現在知道有哪些重要的日誌紀錄需要收容，但我們組織內部的主機數量繁多，沒辦法同時一次性的導入，那我們該如何評估導入的順序，排定優先順序？\n我們可以先考慮主機的用途，並搭配該資產的 CIA 重要度（ Confidentiality 機密性, Integrity 完整性 and Availability 可用性）評估，如高機密性的主機（包含機敏資訊之資料庫、AD 主機等），或是具有對外服務風險較高之主機，以下我們條列出幾種類主機可以先視為首要納入 SOC 監控之主機：\nAD 主機 機敏資料庫主機 DMZ 上對外營運服務之主機 VPN 跳板機 含有較多機敏資訊之 IT / RD / 高層主管 個人電腦 與第三方供應商交換資料所使用之伺服器（供應鏈） 此外，如企業有採用雲端環境，且需要取得或是符合國際資安規範 (如 ISO 27001:2022 / NIST / PCI-DSS / HIPPA / GDPR… 等)，再規定內須定時確認所採用之雲端環境現況是否有與標準不符之處的情況下，企業可額外採用如 CSPM (Cloud Security Posture Management) 這類型的產品，定義好對應之國際規範後定義掃描時間，並將掃描之結果推送至 SOC，如此便可讓企業在第一時間知道雲端環境之現況以及可安排資源進行問題改善排除。\n","wordCount":"139","inLanguage":"en","datePublished":"2024-05-23T11:12:09+08:00","dateModified":"2024-05-23T11:12:09+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.garytan.tw/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/"},"publisher":{"@type":"Organization","name":"Gary Blog","logo":{"@type":"ImageObject","url":"https://blog.garytan.tw/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.garytan.tw/ accesskey=h title="Gary Blog (Alt + H)">Gary Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.garytan.tw/archives/ title=archives><span>archives</span></a></li><li><a href=https://blog.garytan.tw/categories/ title=categories><span>categories</span></a></li><li><a href=https://blog.garytan.tw/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">企業該如何評估 SOC 需要收容哪種資料</h1><div class=post-meta><span title='2024-05-23 11:12:09 +0800 CST'>May 23, 2024</span></div></header><div class=post-content><p><a href=https://www.ecloudvalley.com/tw/blog/sa-talks-how-should-organization-evaluate-which-data-soc-needs-to-collect>eCloudValley: 架構師淺談 企業該如何評估 SOC 需要收容哪種資料</a></p><p>我們可以藉由 SOC 收容各種作業系統、設備以及應用程式產出之日誌紀錄進行關聯分析，我們可以從收容的各端點日誌紀錄發現可能潛在的攻擊風險。那身為資安工程師的我們，該如何去評估決定該將哪些日誌紀錄送至 SOC 中進行儲存及分析？以一般雲端環境如 AWS 為例，我們首要先收容的日誌紀錄會是與 AWS 基礎設施相關的紀錄內容，如：</p><ol><li>VPC flow log</li><li>RDS audit log/Aurora audit log</li><li>AWS WAF log</li><li>AWS Cloudtrail log</li><li>AWS GuardDuty log</li><li>Amazon CloudFront log</li><li>Elastic load balancing (ALB) log</li></ol><p>那於地端環境呢？在地端環境中我們可以收容哪些內容，來增加我們整體的資安防禦能力。</p><p>在以往我們事件調查時的經驗，常常會遇到日誌紀錄收集不完全而造成線索中斷，無法完整的還原整起攻擊事件的全貌，我們可以藉由收容以下的日誌內容以保全完整的攻擊軌跡。</p><ol><li>Windows eventlog</li></ol><ul><li>開啟命令列程序稽核（Command line auditing）
可於群組原則中開啟此功能（電腦設定 > Windows 設定 > 安全性設定 > 進階稽核設定 > 詳細追蹤 > 稽核程序建立），並且開啟新的原則設定（系統管理範本 > 系統 > 稽核程序建立 > 在程序建立事件中包括命令列），開啟此功能後若有程式執行系統指令即會在 Security eventlog 中記錄一筆 4688 的紀錄。</li></ul><p><img alt=audit_1 loading=lazy src=/img/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/1388643462664ef1c9f24eb.png>
<img alt=audit_2 loading=lazy src=/img/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/486989219664ef1e51c3c4.png></p><ul><li>開啟稽核原則
可將稽核原則（電腦設定 > Windows 設定 > 安全性設定 > 本機原則 > 稽核原則 ）中，「物件存取」與「程序追蹤」以外的項目均同步開啟稽核成功及失敗紀錄。</li></ul><p><img alt=audit_3 loading=lazy src=/img/posts/security/how-should-organization-evaluate-which-data-soc-needs-to-collect/2091054252664ef20b0fd5b.png></p><ol start=2><li><p>端點 EDR/MDR Log</p></li><li><p>端點防毒 Log</p></li><li><p>地端基礎設施 Log（VPN/防火牆等主機）</p></li><li><p>遠端管理工具</p></li></ol><ul><li>如：AnyDesk/TeamViewer</li></ul><p>我們現在知道有哪些重要的日誌紀錄需要收容，但我們組織內部的主機數量繁多，沒辦法同時一次性的導入，那我們該如何評估導入的順序，排定優先順序？</p><p>我們可以先考慮主機的用途，並搭配該資產的 CIA 重要度（ Confidentiality 機密性, Integrity 完整性 and Availability 可用性）評估，如高機密性的主機（包含機敏資訊之資料庫、AD 主機等），或是具有對外服務風險較高之主機，以下我們條列出幾種類主機可以先視為首要納入 SOC 監控之主機：</p><ol><li>AD 主機</li><li>機敏資料庫主機</li><li>DMZ 上對外營運服務之主機</li><li>VPN 跳板機</li><li>含有較多機敏資訊之 IT / RD / 高層主管 個人電腦</li><li>與第三方供應商交換資料所使用之伺服器（供應鏈）</li></ol><p>此外，如企業有採用雲端環境，且需要取得或是符合國際資安規範 (如 ISO 27001:2022 / NIST / PCI-DSS / HIPPA / GDPR&mldr; 等)，再規定內須定時確認所採用之雲端環境現況是否有與標準不符之處的情況下，企業可額外採用如 CSPM (Cloud Security Posture Management) 這類型的產品，定義好對應之國際規範後定義掃描時間，並將掃描之結果推送至 SOC，如此便可讓企業在第一時間知道雲端環境之現況以及可安排資源進行問題改善排除。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.garytan.tw/tags/security/>Security</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.garytan.tw/>Gary Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>